import { Appear, Head, Image } from "mdx-deck";
import { FullScreenCode, Invert, Split } from "mdx-deck/layouts";
import { CodeSurfer } from "mdx-deck-code-surfer";
import nightOwl from "prism-react-renderer/themes/nightOwl";
export { future as theme } from "mdx-deck/themes";


<Head>
  <title>Testing mail service with Playwright</title>
  <meta itemProp="name" content="Testing mail service with Playwright" />
  <meta itemProp="description" content="Testing mail service with Playwright" />
  <meta property="og:title" content="Testing mail service with Playwright" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Testing mail service with Playwright" />
  <meta property="og:site_name" content="Testing mail service with Playwright" />
  <meta property="article:section" content="Testing mail service with Playwright" />
</Head>


# Testing mail service

🎭 with Playwright 🎭

#### Kat Kmiotek
---


### We send to user:

<Appear>
  <p>
    📧 newsletters,
  </p>
  <p>
    📧 order confirmation,
  </p>
  <p>
    📧 reset password link,
  </p>
  <p>
    📧 email verification request,
  </p>
  <p>
    📧 acknowledge of receiving their message,
  </p>
  <p>
    📧 notifications,
  </p>
</Appear>


export default Split

---

### We use 3rd party providers:

[Amazon SES](https://aws.amazon.com/ses/)
<p>   </p>
[MailChimp](https://mailchimp.com/en-gb/?currency=GBP)
<p>   </p>

[Postmark](https://postmarkapp.com/)
<p>   </p>

[SendGrid](https://sendgrid.com/)

export default Split


---

### Delivered! 📫

---

### But what gets delivered to the user?
<Appear>
  <p>
  can they click the link and reset password?
  </p>
  <p>
  does verification email takes them to the correct domain?
  </p>
  <p>
   does content matches our design system?
  </p>
  <p>
    doesn't contain any private data?
  </p>
  <p>
    and doesn't contain the "this is a test in dev environment" string as the email subject?
  </p>
</Appear>


---

<Image src={require("!file-loader!./img/prod.png")} size="contain" />


---

<Image src={require("!file-loader!./img/test.png")} size="contain" />

---

### Fake SMTP server ⚙️

- [Mailtrap](https://mailtrap.io/)
- [Mailosaur](https://mailosaur.com/)
- [Mailcatcher](https://mailcatcher.me/)
- [Mailhog](https://github.com/mailhog/MailHog)

---

<Image src={require("!file-loader!./img/mailbox.png")} size="contain" />

---

<Image src={require("!file-loader!./img/response.png")} size="contain" />


---
<CodeSurfer
  title="Test"
  code={require("!raw-loader!./examples/test.js")}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  dark={false}
  steps={[
    { range: [43, 53], notes: "pseudo-code ✏️" },
  ]}
/>
---
<CodeSurfer
  title="Fixture with emailAPI context"
  code={require("!raw-loader!./examples/fixtures.js")}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  dark={false}
  steps={[
    { range: [6, 15], notes: "base url and headers ✏️" },
  ]}
/>
---

<CodeSurfer
  title="Getting email from SMTP server"
  code={require("!raw-loader!./examples/email-api.js")}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  dark={false}
  steps={[
    { range: [13, 22], notes: "GET email ✏️" },
    { range: [26, 28], notes: "get 1st item and decode body ✏️" },
    { range: [1, 2], notes: "helper libraries ✏️" },
    { range: [29, 30], notes: "and return email body ✏️" },
  ]}
/>

---
<CodeSurfer
  title="Use HTML Body to render email page"
  code={require("!raw-loader!./examples/email-page.js")}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  dark={false}
  steps={[
    { range: [12, 17], notes: "Render HTML ✏️" },
    { range: [19, 24], notes: "click verify button ✏️" },
  ]}
/>

---
<CodeSurfer
  title="Test"
  code={require("!raw-loader!./examples/test.js")}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  dark={false}
  steps={[
    { range: [5, 16] },
  ]}
/>
---
<Image src={require("!file-loader!./img/emailBody.png")} size="contain" />
---
<Image src={require("!file-loader!./img/newTab.png")} size="contain" />
---
<CodeSurfer
  title="More tests"
  code={require("!raw-loader!./examples/test.js")}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  dark={false}
  steps={[
    { range: [27, 27], notes: "Visual regression"  },
    { range: [39, 40], notes: "get values of element" },
  ]}
/>
---
<Appear>
  <p>
    ✅ checked that email got delivered to user
  </p>
  <p>
    ✅ checked functionality of button
  </p>
  <p>
    ✅ checked navigation to correct url
  </p>
  <p>
    ✅ checked visual changes in email body
  </p>
  <p>
    ✅ assert that DOM elements have expected attributes
  </p>
</Appear>
---
### Useful links
- [Mailhog Swagger](https://github.com/mailhog/MailHog/blob/master/docs/APIv2/swagger-2.0.json)
- [Mailhog Docker with auth](https://github.com/KatKmiotek/mailhog_with_auth)
- [=3D](https://stackoverflow.com/questions/4016067/whats-a-3d-doing-in-this-html)
- [ThunderClient](https://www.thunderclient.com/)
- [contact me](https://www.linkedin.com/in/katarzyna-kmiotek/)

export default Split

---

 <h1>Thank you!</h1>
 <Image style={{margin: '0 auto'}} src={require("!file-loader!./img/qrcode.png")} width={200}
  height={200} />


---
